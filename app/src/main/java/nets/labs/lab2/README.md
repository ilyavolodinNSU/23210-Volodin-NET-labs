# File Transfer Server & Client

Проект представляет собой клиент-серверное приложение для передачи файлов с мониторингом скорости в реальном времени.

## Архитектура

### Серверная часть (`nets.labs.lab2`)
- **Server** - основной класс сервера, принимающий подключения
- **ClientHandler** - обработчик клиентских подключений
- **SpeedMonitor** - мониторинг скорости передачи в реальном времени
- **FileValidator** - валидация файлов и проверка безопасности
- **Constants** - централизованное хранение констант

### Клиентская часть (`nets.labs.lab2.client`)
- **Client** - клиент для отправки файлов на сервер

## Функциональность

### Сервер
- Многопоточная обработка клиентов
- Мониторинг скорости передачи (мгновенная и средняя скорость)
- Безопасное сохранение файлов в директорию `uploads`
- Проверка безопасности путей файлов
- Валидация размера и имени файла
- Подтверждение успешной передачи

### Клиент
- Передача файлов на сервер
- Проверка доступности и читаемости файлов
- Обработка различных сценариев ответа сервера
- Информативное логирование процесса передачи

## Особенности

- **Безопасность**: Проверка canonical paths для предотвращения path traversal атак
- **Производительность**: Буферизированное чтение/запись (8KB буфер)
- **Мониторинг**: Отслеживание скорости передачи с обновлением каждую секунду
- **Надежность**: Проверка целостности данных и размера файла
- **Логирование**: Детальная информация о процессе передачи

## Использование

### Запуск сервера
```java
Server server = new Server();
server.start(8080); // запуск на порту 8080
```

### Отправка файла клиентом
```java
Client.sendFile("path/to/file.txt", "localhost", 8080);
```

### Остановка сервера
```java
server.stop();
```

## Протокол передачи

1. Клиент отправляет:
   - Длина имени файла (4 байта)
   - Имя файла в UTF-8
   - Размер файла (8 байтов)
   - Данные файла

2. Сервер отвечает:
   - `1` - успех
   - `0` - ошибка

## Конфигурация

Основные параметры в классе `Constants`:
- `SPEED_MONITOR_INTERVAL_MS` - интервал обновления скорости (1000 мс)
- `MAX_FILENAME_LENGTH` - максимальная длина имени файла (4096 байт)
- `BUFFER_SIZE` - размер буфера передачи (8192 байт)
- `UPLOADS_DIR` - директория для загруженных файлов ("uploads")

## Требования

- Java 8 или выше
- Lombok (для аннотаций @Data)

## Безопасность

- Проверка длины имени файла
- Валидация путей для предотвращения directory traversal
- Ограничение на максимальный размер имени файла
- Изоляция загруженных файлов в отдельной директории